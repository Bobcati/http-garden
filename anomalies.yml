# This file generated by diagnose_anomalies.py
# This yaml file tracks the acceptable parsing anomalies in the servers.
aiohttp:
  allows-missing-host-header: true
akamai:
  requires-specific-host-header: true
  doesnt-support-version: true
  method-whitelist: ['DELETE', 'GET']
  added-headers: ['True-Client-IP', 'X-Forwarded-For', 'Akamai-Origin-Hop', 'X-Akamai-G2G-Slot', 'Accept-Encoding', 'Via', 'Cache-Control', 'X-Akamai-CONFIG-LOG-DETAIL', 'CDN-Loop', 'TE', 'Connection']
  removed-headers: ['connection', 'content-length']
  trashed-headers: ['Host']
  requires-length-in-post: true
apache_httpd:
  allows-http-0-9: true
apache_httpd_proxy:
  allows-http-0-9: true
  doesnt-support-version: true
  added-headers: ['X-Forwarded-Host', 'X-Forwarded-Server', 'Connection', 'X-Forwarded-For']
  removed-headers: ['connection']
apache_tomcat:
  allows-http-0-9: true
  method-whitelist: ['DELETE', 'GET', 'POST', 'PUT']
apache_trafficserver:
  doesnt-support-version: true
  allows-missing-host-header: true
  added-headers: ['Host', 'Via', 'Client-ip', 'X-Forwarded-For']
  removed-headers: ['connection']
  trashed-headers: ['Host']
  requires-length-in-post: true
appweb:
  allows-missing-host-header: true
appweb_proxy:
  doesnt-support-version: true
  allows-missing-host-header: true
  method-whitelist: ['GET', 'POST']
  added-headers: ['Accept-Ranges', 'Content-Type', 'User-Agent', 'X-Client', 'Date']
  removed-headers: ['connection', 'content-length']
aws_c_http:
  doesnt-support-version: true
  allows-missing-host-header: true
aws_cloudfront:
  requires-specific-host-header: true
  allows-http-0-9: true
  doesnt-support-version: true
  method-whitelist: ['DELETE', 'GET', 'PATCH', 'POST', 'PUT']
  added-headers: ['CloudFront-Is-Mobile-Viewer', 'CloudFront-Is-Tablet-Viewer', 'CloudFront-Viewer-Country', 'X-Forwarded-For', 'CloudFront-Forwarded-Proto', 'user-agent', 'Via', 'CloudFront-Is-Desktop-Viewer', 'content-length', 'CloudFront-Viewer-ASN', 'CloudFront-Is-SmartTV-Viewer', 'X-Amz-Cf-Id', 'Connection']
  removed-headers: ['connection']
  trashed-headers: ['Host']
busybox_httpd_proxy:
  allows-missing-host-header: true
  doesnt-support-persistence: true
cheroot:
  allows-missing-host-header: true
  header-name-translation: {'-': '_'}
cloudflare:
  requires-specific-host-header: true
  allows-http-0-9: true
  doesnt-support-version: true
  method-character-blacklist: "!#$%&'*+.^`|~"
  requires-alphabetical-method: true
  added-headers: ['cf-ray', 'CF-IPCountry', 'X-Forwarded-Proto', 'CF-Visitor', 'x-forwarded-for', 'Connection', 'CF-Connecting-IP', 'cdn-loop', 'accept-encoding']
  removed-headers: ['connection']
  trashed-headers: ['Host']
cpp_httplib:
  allows-missing-host-header: true
  method-whitelist: ['DELETE', 'GET']
  requires-length-in-post: true
cpython_stdlib:
  allows-http-0-9: true
  allows-missing-host-header: true
  header-name-translation: {'-': '_'}
  added-headers: ['content_type', 'content_length']
  doesnt-support-persistence: true
dart_stdlib:
  allows-missing-host-header: true
eclipse_grizzly:
  allows-http-0-9: true
eclipse_jetty:
  allows-http-0-9: true
  method-whitelist: ['DELETE', 'GET', 'POST', 'PUT']
envoy:
  allows-http-0-9: true
  doesnt-support-version: true
  method-whitelist: ['ACL', 'BIND', 'CHECKOUT', 'COPY', 'DELETE', 'GET', 'LINK', 'LOCK', 'MERGE', 'MKACTIVITY', 'MKCALENDAR', 'MKCOL', 'MOVE', 'NOTIFY', 'PATCH', 'POST', 'PROPFIND', 'PROPPATCH', 'PURGE', 'PUT', 'REBIND', 'REPORT', 'SEARCH', 'SOURCE', 'SUBSCRIBE', 'UNBIND', 'UNLINK', 'UNLOCK', 'UNSUBSCRIBE']
  added-headers: ['x-envoy-external-address', 'x-forwarded-for', 'x-envoy-expected-rq-timeout-ms', 'x-request-id', 'x-forwarded-proto']
  removed-headers: ['connection']
fasthttp:
  allows-missing-host-header: true
  added-headers: ['content-length']
go_stdlib:
go_stdlib_proxy:
  doesnt-support-version: true
  added-headers: ['Accept-Encoding', 'X-Forwarded-For']
  removed-headers: ['connection', 'content-length']
google_classic:
  allows-http-0-9: true
  doesnt-support-version: true
  allows-missing-host-header: true
  added-headers: ['X-Cloud-Trace-Context', 'X-Forwarded-Proto', 'Host', 'X-Forwarded-For', 'Via', 'CDN-Loop', 'Connection']
  removed-headers: ['connection']
  requires-length-in-post: true
google_frontend:
  requires-specific-host-header: true
gunicorn:
  allows-missing-host-header: true
  method-character-blacklist: "#"
  requires-alphabetical-method: true
  header-name-translation: {'-': '_'}
h2o:
  allows-missing-host-header: true
  header-name-translation: {'-': '_'}
  added-headers: ['host']
h2o_proxy:
  doesnt-support-version: true
  allows-missing-host-header: true
  added-headers: ['host', 'x-forwarded-for', 'connection', 'x-forwarded-proto', 'via']
  removed-headers: ['connection']
haproxy:
  allows-missing-host-header: true
  removed-headers: ['connection']
haproxy_fcgi:
  allows-missing-host-header: true
  added-headers: ['content-length']
  removed-headers: ['connection']
haproxy_invalid:
  allows-http-0-9: true
  allows-missing-host-header: true
  removed-headers: ['connection']
hyper:
  allows-missing-host-header: true
hypercorn:
iis:
  allows-http-0-9: true
  added-headers: ['content-length', 'content-type']
  requires-length-in-post: true
iis_proxy:
  added-headers: ['X-Forwarded-For', 'X-ARR-LOG-ID', 'Max-Forwards', 'X-Original-URL', 'Connection']
  removed-headers: ['connection']
  trashed-headers: ['Host']
  requires-length-in-post: true
ktor:
  doesnt-support-version: true
libevent:
  allows-missing-host-header: true
  method-whitelist: ['DELETE', 'GET', 'POST', 'PUT']
libmicrohttpd:
libsoup:
lighttpd:
  method-whitelist: ['ACL', 'BASELINE-CONTROL', 'BIND', 'CHECKIN', 'CHECKOUT', 'COPY', 'DELETE', 'GET', 'LABEL', 'LINK', 'LOCK', 'MERGE', 'MKACTIVITY', 'MKCALENDAR', 'MKCOL', 'MKREDIRECTREF', 'MKWORKSPACE', 'MOVE', 'ORDERPATCH', 'PATCH', 'PROPFIND', 'PROPPATCH', 'PUT', 'QUERY', 'REBIND', 'REPORT', 'SEARCH', 'UNBIND', 'UNCHECKOUT', 'UNLINK', 'UNLOCK', 'UPDATE', 'UPDATEREDIRECTREF', 'VERSION-CONTROL']
  added-headers: ['content-length']
  requires-length-in-post: true
lighttpd_proxy:
  doesnt-support-version: true
  method-whitelist: ['ACL', 'BASELINE-CONTROL', 'BIND', 'CHECKIN', 'CHECKOUT', 'COPY', 'DELETE', 'GET', 'LABEL', 'LINK', 'LOCK', 'MERGE', 'MKACTIVITY', 'MKCALENDAR', 'MKCOL', 'MKREDIRECTREF', 'MKWORKSPACE', 'MOVE', 'ORDERPATCH', 'PATCH', 'PROPFIND', 'PROPPATCH', 'PUT', 'QUERY', 'REBIND', 'REPORT', 'SEARCH', 'UNBIND', 'UNCHECKOUT', 'UNLINK', 'UNLOCK', 'UPDATE', 'UPDATEREDIRECTREF', 'VERSION-CONTROL']
  added-headers: ['X-Forwarded-Host', 'X-Host', 'X-Forwarded-Proto', 'X-Forwarded-For', 'Content-Length', 'Connection']
  removed-headers: ['connection']
  requires-length-in-post: true
mongoose:
  allows-http-0-9: true
  allows-missing-host-header: true
  requires-length-in-post: true
netty:
  allows-missing-host-header: true
nginx:
  allows-http-0-9: true
  method-character-blacklist: "!#$%&'*+.^`|~"
  requires-alphabetical-method: true
  added-headers: ['content-length', 'content-type']
nginx_proxy:
  doesnt-support-version: true
  method-character-blacklist: "!#$%&'*+.^`|~"
  requires-alphabetical-method: true
  added-headers: ['Connection']
  removed-headers: ['connection']
  trashed-headers: ['Host']
node_stdlib:
  allows-http-0-9: true
  method-whitelist: ['ACL', 'BIND', 'CHECKOUT', 'COPY', 'DELETE', 'GET', 'LINK', 'LOCK', 'M-SEARCH', 'MERGE', 'MKACTIVITY', 'MKCALENDAR', 'MKCOL', 'MOVE', 'NOTIFY', 'PATCH', 'POST', 'PROPFIND', 'PROPPATCH', 'PURGE', 'PUT', 'QUERY', 'REBIND', 'REPORT', 'SEARCH', 'SOURCE', 'SUBSCRIBE', 'UNBIND', 'UNLINK', 'UNLOCK', 'UNSUBSCRIBE']
openbsd_httpd:
  method-whitelist: ['ACL', 'BASELINE-CONTROL', 'CHECKIN', 'CHECKOUT', 'COPY', 'DELETE', 'GET', 'LABEL', 'LOCK', 'MERGE', 'MKACTIVITY', 'MKCOL', 'MKREDIRECTREF', 'MKWORKSPACE', 'MOVE', 'ORDERPATCH', 'PATCH', 'POST', 'PROPFIND', 'PROPPATCH', 'PUT', 'REPORT', 'SEARCH', 'UNCHECKOUT', 'UNLOCK', 'UPDATE', 'UPDATEREDIRECTREF', 'VERSION-CONTROL']
openbsd_relayd:
  allows-missing-host-header: true
  method-whitelist: ['ACL', 'BASELINE-CONTROL', 'CHECKIN', 'CHECKOUT', 'COPY', 'DELETE', 'GET', 'LABEL', 'LOCK', 'MERGE', 'MKACTIVITY', 'MKCOL', 'MKREDIRECTREF', 'MKWORKSPACE', 'MOVE', 'ORDERPATCH', 'PATCH', 'POST', 'PROPFIND', 'PROPPATCH', 'PUT', 'REPORT', 'SEARCH', 'UNCHECKOUT', 'UNLOCK', 'UPDATE', 'UPDATEREDIRECTREF', 'VERSION-CONTROL']
  added-headers: ['Connection']
  removed-headers: ['content-length']
  doesnt-support-persistence: true
openjdk_stdlib:
  allows-missing-host-header: true
openlitespeed:
  allows-missing-host-header: true
  method-whitelist: ['BASELINE-CONTROL', 'BIND', 'CHECKIN', 'COPY', 'DELETE', 'GET', 'LABEL', 'LOCK', 'MERGE', 'MKACTIVITY', 'MKCOL', 'MKWORKSPACE', 'MOVE', 'PATCH', 'POST', 'PROPFIND', 'PROPPATCH', 'PURGE', 'PUT', 'REFRESH', 'REPORT', 'SEARCH', 'UNCHECKOUT', 'UNLOCK', 'UPDATE', 'VERSION-CONTROL']
openlitespeed_proxy:
  doesnt-support-version: true
  allows-missing-host-header: true
  method-whitelist: ['BASELINE-CONTROL', 'BIND', 'CHECKIN', 'COPY', 'DELETE', 'GET', 'LABEL', 'LOCK', 'MERGE', 'MKACTIVITY', 'MKCOL', 'MKWORKSPACE', 'MOVE', 'PATCH', 'POST', 'PROPFIND', 'PROPPATCH', 'PURGE', 'PUT', 'REFRESH', 'REPORT', 'SEARCH', 'UNCHECKOUT', 'UNLOCK', 'UPDATE', 'VERSION-CONTROL']
  added-headers: ['X-Forwarded-Host', 'Accept-Encoding', 'X-Forwarded-For']
openwrt_uhttpd:
  allows-missing-host-header: true
  method-whitelist: ['DELETE', 'GET', 'PATCH', 'POST', 'PUT']
php_stdlib:
  allows-http-0-9: true
  allows-missing-host-header: true
  method-whitelist: ['CHECKOUT', 'COPY', 'DELETE', 'GET', 'LOCK', 'M-SEARCH', 'MERGE', 'MKACTIVITY', 'MKCALENDAR', 'MKCOL', 'MOVE', 'NOTIFY', 'PATCH', 'POST', 'PROPFIND', 'PROPPATCH', 'PUT', 'REPORT', 'SEARCH', 'SUBSCRIBE', 'UNLOCK', 'UNSUBSCRIBE']
  doesnt-support-persistence: true
pingora:
  allows-missing-host-header: true
pound:
  allows-missing-host-header: true
  method-whitelist: ['GET', 'POST']
  added-headers: ['X-Forwarded-Proto', 'X-Forwarded-Port', 'X-Forwarded-For']
protocol_http1:
  allows-missing-host-header: true
  removed-headers: ['content-length']
puma:
  allows-missing-host-header: true
  method-character-blacklist: "!#%&'*+^`|~"
  header-name-translation: {'-': '_'}
servicetalk:
  allows-missing-host-header: true
spring_cloud_gateway:
  doesnt-support-version: true
  allows-missing-host-header: true
  added-headers: ['X-Forwarded-Host', 'X-Forwarded-Proto', 'host', 'X-Forwarded-Port', 'X-Forwarded-For', 'user-agent', 'content-length', 'accept', 'Forwarded']
  removed-headers: ['connection']
  trashed-headers: ['Host']
squid:
  doesnt-support-version: true
  allows-missing-host-header: true
  added-headers: ['Host', 'X-Forwarded-For', 'Surrogate-Capability', 'Cache-Control', 'Via', 'Connection']
  removed-headers: ['connection']
  trashed-headers: ['Host']
tornado:
  allows-missing-host-header: true
  method-whitelist: ['DELETE', 'GET', 'PATCH', 'POST', 'PUT']
twisted:
  allows-missing-host-header: true
undertow:
uvicorn:
varnish:
  doesnt-support-version: true
  allows-missing-host-header: true
  added-headers: ['Host', 'Via', 'X-Varnish', 'X-Forwarded-For']
  removed-headers: ['connection', 'content-length']
waitress:
  allows-http-0-9: true
  allows-missing-host-header: true
  header-name-translation: {'-': '_'}
webrick:
  allows-http-0-9: true
  doesnt-support-version: true
  allows-missing-host-header: true
  header-name-translation: {'-': '_'}
  removed-headers: ['content-length']
  requires-length-in-post: true
yahns:
  allows-http-0-9: true
  allows-missing-host-header: true
  header-name-translation: {'-': '_'}
yahns_proxy:
  allows-http-0-9: true
  allows-missing-host-header: true
  added-headers: ['X-Forwarded-Proto', 'X-Forwarded-For']
  removed-headers: ['connection']
